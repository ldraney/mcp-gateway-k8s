apiVersion: v1
kind: ConfigMap
metadata:
  name: openclaw-config
  namespace: openclaw
data:
  openclaw.json: |
    {
      "gateway": {
        "mode": "local",
        "port": 18789,
        "bind": "lan"
      },
      "models": {
        "providers": {
          "ollama": {
            "baseUrl": "http://ollama:11434/v1",
            "apiKey": "not-required",
            "api": "openai-completions",
            "models": [
              {
                "id": "llama3.2:3b-16k",
                "name": "Llama 3.2 3B 16K",
                "reasoning": false,
                "input": ["text"],
                "cost": { "input": 0, "output": 0, "cacheRead": 0, "cacheWrite": 0 },
                "contextWindow": 16384,
                "maxTokens": 8192
              }
            ]
          }
        }
      },
      "channels": {
        "telegram": {
          "enabled": true,
          "tokenFile": "/run/secrets/telegram-bot-token",
          "dmPolicy": "open",
          "allowFrom": ["*"],
          "groupPolicy": "disabled",
          "streamMode": "partial",
          "reactionLevel": "ack"
        }
      },
      "plugins": {
        "enabled": true,
        "entries": {
          "telegram": {
            "enabled": true
          },
          "openclaw-mcp-bridge": {
            "enabled": true,
            "config": {
              "tokenDbPath": "/data/tokens/mcp-bridge-tokens.db",
              "servers": [
                {
                  "name": "Notion",
                  "url": "http://notion-mcp-remote:8000",
                  "prefix": "notion",
                  "path": "/mcp"
                },
                {
                  "name": "Google Calendar",
                  "url": "http://gcal-mcp-remote:8001",
                  "prefix": "gcal",
                  "path": "/mcp"
                },
                {
                  "name": "Gmail",
                  "url": "http://gmail-mcp-remote:8002",
                  "prefix": "gmail",
                  "path": "/mcp"
                }
              ]
            }
          }
        }
      },
      "agents": {
        "defaults": {
          "model": {
            "primary": "ollama/llama3.2:3b-16k"
          },
          "maxConcurrent": 4,
          "subagents": {
            "maxConcurrent": 8
          },
          "heartbeat": {
            "every": "30m"
          },
          "compaction": {
            "mode": "safeguard"
          }
        }
      }
    }
